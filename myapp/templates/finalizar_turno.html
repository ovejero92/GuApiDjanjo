{% extends 'layouts/dashboard_base.html' %}
{% block title %}finalizar turno - Turnos Online{% endblock %}

{% block dashboard_content %}
<div class="dashboard-section">
    
    <h1>{{ titulo_pagina }}</h1>
    
    <p>Confirma o ajusta el monto final cobrado por este turno. Al guardar, el turno quedar√° marcado como <strong>Completado</strong>.</p>
    <hr>
    
    <div class="turno-info-card">
        <p><strong>Cliente:</strong> {{ turno.cliente.first_name|default:turno.cliente.username }}</p>
        <p><strong>Fecha y Hora:</strong> {{ turno.fecha|date:"d/m/Y" }} a las {{ turno.hora|time:"H:i" }}</p>
        <p><strong>Servicios Solicitados:</strong>
            <span class="servicio-tag-container-inline">
                {% for sub in turno.sub_servicios_solicitados.all %}
                    <span class="servicio-tag-inline">{{ sub.nombre }}</span>
                {% empty %}
                    <em>Sin servicios especificados.</em>
                {% endfor %}
            </span>
        </p>
    </div>

    <form method="post" class="finalizar-form">
        {% csrf_token %}
        
        <div class="form-group">
            <label for="{{ form.ingreso_real.id_for_label }}">Ingreso Real Cobrado:</label>
            {{ form.ingreso_real }}
            {% if form.ingreso_real.errors %}
                <div class="form-error">{{ form.ingreso_real.errors|join:", " }}</div>
            {% endif %}
        </div>
        <div class="form-group" style="margin-top: 20px;">
            <label for="{{ form.medio_de_pago_final.id_for_label }}">{{ form.medio_de_pago_final.label }}</label>
            {{ form.medio_de_pago_final }}
        </div>
        
        <div class="action-buttons" style="margin-top: 20px;">
            <button type="submit" class="btn-confirmar">Guardar Ingreso</button>
            <a href="{% url 'dashboard_turnos' %}" class="btn-cancelar" style="text-decoration: none; padding: 10px 15px; color: white;">Cancelar</a>
        </div>
    </form>
</div>

{% endblock %}