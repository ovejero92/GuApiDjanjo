{% extends 'layouts/dashboard_base.html' %}
{% block dashboard_title %}Detalle del Servicio{% endblock %}

{% block dashboard_content %}
    
    {% if no_hay_servicio %}
        <div class="dashboard-section"><p>Aún no tienes un servicio asignado.</p></div>
    {% else %}
        <h1>Detalles del Negocio</h1>
        <p>Edita la información pública que verán tus clientes sobre tu negocio.</p>
        
        <div class="dashboard-section">
            <form method="post">
                {% csrf_token %}
                {{ update_form.as_p }}
                <button type="submit" name="guardar_detalles" class="btn-submit">Guardar Detalles del Negocio</button>
            </form>
        </div>
    {% endif %}

    <style>
        
        /* Apuntamos al contenedor que Django crea para el campo de checkboxes */
        #div_id_medios_de_pago_aceptados ul {
            list-style-type: none; /* Quitamos los puntos de la lista */
            padding: 15px;
            margin: 0;
            background-color: #f8f9fa; /* Un fondo claro para la caja */
            border: 1px solid #ced4da; /* Un borde sutil */
            border-radius: 5px;
            max-height: 150px; /* Le damos una altura máxima con scroll */
            overflow-y: auto; /* Añade scroll si hay muchas opciones */
        }
        
        /* Estilo para cada opción individual (cada checkbox) */
        #div_id_medios_de_pago_aceptados ul li {
            padding: 5px 0;
            display: block; /* Asegura que cada opción ocupe su propia línea */
        }
        
        #div_id_medios_de_pago_aceptados label {
            margin-left: 8px; /* Un poco de espacio entre el checkbox y el texto */
        }
        
    </style>
    <script>
document.addEventListener('DOMContentLoaded', function() {
    // Django crea el id como "id_" + nombre_del_campo
    const selectMultiple = document.getElementById('id_medios_de_pago_aceptados');

    if (selectMultiple) {
        // Le damos un poco de estilo para que se vea mejor
        selectMultiple.style.height = 'auto';
        selectMultiple.style.padding = '10px';
        selectMultiple.style.backgroundColor = '#333';
        selectMultiple.style.color = '#fff';
        selectMultiple.style.border = '1px solid #555';

        // Variable para evitar el comportamiento por defecto de "deseleccionar"
        let lastSelected = null;

        // Evitamos que se pueda deseleccionar con Ctrl+Clic, es confuso
        selectMultiple.addEventListener('mousedown', function(e) {
            const option = e.target;
            if (option.tagName === 'OPTION') {
                e.preventDefault(); // ¡Prevenimos el comportamiento por defecto del navegador!
                
                // Hacemos el toggle: si está seleccionada la deseleccionamos, y viceversa
                option.selected = !option.selected;
            }
        });
    }
});
</script>
{% endblock %}